1.#include <stdio.h>
2.#include <stdlib.h>
3.#include <errno.h>
4.#include <string.h>
5.
6.int main()
7.{
8.    int pid;
9.    int n;
10.    int fd[2];
11.    char buf[1000 * 6] = {0};
12.
13.    if(pipe(fd) < 0)
14.    {
15.        perror("Fail to pipe");
16.        exit(EXIT_FAILURE);
17.    }
18.
19.    if((pid = fork()) < 0)
20.    {
21.        perror("Fail to fork");
22.        exit(EXIT_FAILURE);
23.
24.    }else if(pid == 0){
25.        
26.        close(fd[1]);
27.        sleep(5);
28.        close(fd[0]);
29.        printf("Read port close.\n");
30.        sleep(3);
31.
32.    }else{
33.
34.        close(fd[0]);
35.        
36.        while(1)
37.        {
38.            n = write(fd[1],buf,sizeof(buf));
39.            printf("Write %d bytes to pipe.\n",n);
40.        }
41.    
42.    }
43.
44.    exit(EXIT_SUCCESS);
45.}